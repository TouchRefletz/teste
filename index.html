<!DOCTYPE html>
<html>
<head>
    <title>Enviar para Google Sheets</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <h1>Formulário de Exemplo</h1>

    <form id="meuFormulario">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" required><br><br>

        <label for="email">E-mail:</label>
        <input type="email" id="email" name="email" required><br><br>

        <label for="mensagem">Mensagem:</label>
        <textarea id="mensagem" name="mensagem" required></textarea><br><br>

        <button type="submit">Enviar</button>
    </form>

    <script>
        $(document).ready(function() {
            $('#meuFormulario').submit(function(event) {
                event.preventDefault(); // Evitar que o formulário seja enviado normalmente

                // Obter os valores dos campos
                var nome = $('#nome').val();
                var email = $('#email').val();
                var mensagem = $('#mensagem').val();

                // Dados para enviar à planilha
                var data = {
                    values: [
                        [nome, email, mensagem]
                    ]
                };

                // Autenticação com a API do Google Sheets
                gapi.load('client', function() {
                    gapi.client.init({
                        discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
                        clientId: '456387488821-d0dk017bdji7qj72bnkjvqmqshv87c4e.apps.googleusercontent.com',
                        scope: 'https://www.googleapis.com/auth/spreadsheets'
                    }).then(function() {
                        gapi.auth2.getAuthInstance().signIn().then(function() {
                            // Enviar dados para a planilha
                            gapi.client.sheets.spreadsheets.values.append({
                                spreadsheetId: '1cveRHwOvwwvZZW3wTef_VcN7A4qSI2kpd04sG8dhYpY',
                                range: '1cveRHwOvwwvZZW3wTef_VcN7A4qSI2kpd04sG8dhYpY!A2:C2',
                                valueInputOption: 'USER_ENTERED',
                                resource: data
                            }).then(function(response) {
                                alert('Resposta enviada com sucesso para o Google Sheets!');
                            }, function(error) {
                                alert('Erro ao enviar resposta: ' + error.result.error.message);
                            });
                        });
                    });
                });
            });
        });
    </script>

    <script src="https://apis.google.com/js/api.js"></script>
</body>
</html>
